<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>صالون بنات الورد النسائي - نظام الإدارة</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- مكتبة SheetJS لتصدير Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-gold: #D4AF37;
            --light-gold: #F4E4A6;
            --dark-gold: #B8860B;
            --pure-white: #FFFFFF;
            --light-gray: #F8F9FA;
            --medium-gray: #E9ECEF;
            --dark-gray: #6C757D;
            --text-dark: #343A40;
            --success-green: #28A745;
            --danger-red: #DC3545;
            --info-blue: #17A2B8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-gray);
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary-gold) 0%, var(--dark-gold) 100%);
            color: var(--pure-white);
            padding: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }
        
        .logo-text p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .currency-display {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        /* Navigation Styles */
        nav {
            background-color: var(--pure-white);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .nav-tabs {
            display: flex;
            list-style: none;
        }
        
        .nav-tabs li {
            margin: 0;
        }
        
        .nav-tabs li a {
            display: block;
            padding: 18px 25px;
            color: var(--text-dark);
            text-decoration: none;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }
        
        .nav-tabs li a:hover, .nav-tabs li a.active {
            color: var(--primary-gold);
            border-bottom: 3px solid var(--primary-gold);
            background-color: rgba(212, 175, 55, 0.05);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--dark-gray);
        }
        
        /* Main Content Styles */
        .content-section {
            display: none;
            background-color: var(--pure-white);
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--medium-gray);
        }
        
        .section-header h2 {
            color: var(--primary-gold);
            font-size: 1.8rem;
        }
        
        /* Button Styles */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--primary-gold);
            color: var(--pure-white);
        }
        
        .btn-primary:hover {
            background-color: var(--dark-gold);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(212, 175, 55, 0.3);
        }
        
        .btn-success {
            background-color: var(--success-green);
            color: var(--pure-white);
        }
        
        .btn-danger {
            background-color: var(--danger-red);
            color: var(--pure-white);
        }
        
        .btn-info {
            background-color: var(--info-blue);
            color: var(--pure-white);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary-gold);
            color: var(--primary-gold);
        }
        
        .btn-excel {
            background-color: #1D6F42;
            color: white;
        }
        
        .btn-excel:hover {
            background-color: #155D35;
        }
        
        .action-btns {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--medium-gray);
            border-radius: 6px;
            font-size: 1rem;
            transition: border 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-gold);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        /* Table Styles */
        .table-responsive {
            overflow-x: auto;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .data-table th {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--dark-gold);
            padding: 15px;
            text-align: right;
            font-weight: 700;
            border-bottom: 2px solid var(--light-gold);
        }
        
        .data-table td {
            padding: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .data-table tr:hover {
            background-color: rgba(212, 175, 55, 0.05);
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }
        
        .edit-btn {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-green);
        }
        
        .delete-btn {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-red);
        }
        
        .pay-btn {
            background-color: rgba(23, 162, 184, 0.1);
            color: var(--info-blue);
        }
        
        /* Invoice Styles */
        .invoice-preview {
            background-color: var(--pure-white);
            border: 1px solid var(--medium-gray);
            border-radius: 8px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .invoice-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-gold);
        }
        
        .invoice-title {
            color: var(--primary-gold);
            font-size: 2rem;
        }
        
        .invoice-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .invoice-items {
            margin: 30px 0;
        }
        
        .invoice-total {
            text-align: left;
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-gold);
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid var(--light-gold);
        }
        
        /* Footer Styles */
        footer {
            background-color: var(--text-dark);
            color: var(--pure-white);
            padding: 25px 0;
            margin-top: 50px;
            text-align: center;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: var(--pure-white);
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--medium-gray);
        }
        
        .modal-title {
            color: var(--primary-gold);
            font-size: 1.5rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--dark-gray);
        }
        
        /* Dashboard Stats */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background-color: var(--pure-white);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-top: 4px solid var(--primary-gold);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            color: var(--primary-gold);
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: var(--dark-gray);
            font-size: 1rem;
        }
        
        /* Status Badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-paid {
            background-color: rgba(40, 167, 69, 0.15);
            color: var(--success-green);
        }
        
        .status-unpaid {
            background-color: rgba(220, 53, 69, 0.15);
            color: var(--danger-red);
        }
        
        /* Report Filters */
        .report-filters {
            background-color: var(--light-gray);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            min-width: 150px;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
                width: 100%;
            }
            
            .nav-tabs li a {
                padding: 15px;
                border-bottom: 1px solid var(--medium-gray);
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .invoice-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .action-btns {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-crown"></i>
                <div class="logo-text">
                    <h1>صالون بنات الورد النسائي</h1>
                    <p>نظام إدارة الفواتير والخدمات</p>
                </div>
            </div>
            <div class="currency-display">
                <i class="fas fa-dinar-sign"></i> العملة: الدينار الأردني
            </div>
        </div>
    </header>
    
    <!-- Navigation -->
    <nav>
        <div class="container nav-container">
            <ul class="nav-tabs">
                <li><a href="#" class="nav-link active" data-section="dashboard">لوحة التحكم</a></li>
                <li><a href="#" class="nav-link" data-section="services">الخدمات</a></li>
                <li><a href="#" class="nav-link" data-section="invoices">الفواتير</a></li>
                <li><a href="#" class="nav-link" data-section="users">المستخدمين</a></li>
                <li><a href="#" class="nav-link" data-section="reports">التقارير</a></li>
            </ul>
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span id="current-user">منار عيروط</span>
            </div>
        </div>
    </nav>
    
    <!-- Main Content -->
    <main class="container">
        <!-- Dashboard Section -->
        <section id="dashboard" class="content-section active">
            <div class="section-header">
                <h2><i class="fas fa-tachometer-alt"></i> لوحة التحكم</h2>
                <div>تاريخ اليوم: <span id="current-date"></span></div>
            </div>
            
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                    <div class="stat-value" id="total-invoices">0</div>
                    <div class="stat-label">إجمالي الفواتير</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-hand-sparkles"></i>
                    </div>
                    <div class="stat-value" id="total-services">0</div>
                    <div class="stat-label">عدد الخدمات</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-value" id="total-users">0</div>
                    <div class="stat-label">عدد المستخدمين</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-dinar-sign"></i>
                    </div>
                    <div class="stat-value" id="total-revenue">0 د.أ</div>
                    <div class="stat-label">إجمالي الإيرادات</div>
                </div>
            </div>
            
            <div class="section-header">
                <h3><i class="fas fa-history"></i> أحدث الفواتير</h3>
                <button class="btn btn-outline" onclick="showSection('invoices')">عرض الكل</button>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>رقم الفاتورة</th>
                            <th>التاريخ</th>
                            <th>العميل</th>
                            <th>المبلغ</th>
                            <th>الحالة</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="recent-invoices">
                        <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Services Section -->
        <section id="services" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-spa"></i> إدارة الخدمات</h2>
                <div class="action-btns">
                    <button class="btn btn-primary" id="add-service-btn">
                        <i class="fas fa-plus"></i> إضافة خدمة جديدة
                    </button>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>اسم الخدمة</th>
                            <th>السعر (د.أ)</th>
                            <th>المدة (دقيقة)</th>
                            <th>الوصف</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="services-list">
                        <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Invoices Section -->
        <section id="invoices" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-file-invoice"></i> إدارة الفواتير</h2>
                <div class="action-btns">
                    <button class="btn btn-primary" id="create-invoice-btn">
                        <i class="fas fa-plus"></i> إنشاء فاتورة جديدة
                    </button>
                    <button class="btn btn-excel" onclick="exportToExcel()">
                        <i class="fas fa-file-excel"></i> تصدير إلى Excel
                    </button>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>رقم الفاتورة</th>
                            <th>التاريخ</th>
                            <th>اسم العميل</th>
                            <th>رقم الهاتف</th>
                            <th>الخدمات</th>
                            <th>المبلغ الإجمالي</th>
                            <th>الحالة</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="invoices-list">
                        <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Users Section -->
        <section id="users" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-users-cog"></i> إدارة المستخدمين</h2>
                <div class="action-btns">
                    <button class="btn btn-primary" id="add-user-btn">
                        <i class="fas fa-user-plus"></i> إضافة مستخدم جديد
                    </button>
                </div>
            </div>
            
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>اسم المستخدم</th>
                            <th>البريد الإلكتروني</th>
                            <th>رقم الهاتف</th>
                            <th>الدور</th>
                            <th>تاريخ الإضافة</th>
                            <th>الإجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="users-list">
                        <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Reports Section -->
        <section id="reports" class="content-section">
            <div class="section-header">
                <h2><i class="fas fa-chart-bar"></i> التقارير المالية</h2>
                <div class="action-btns">
                    <button class="btn btn-outline" onclick="generateDailyReport()">
                        <i class="fas fa-calendar-day"></i> تقرير يومي
                    </button>
                    <button class="btn btn-outline" onclick="generateMonthlyReport()">
                        <i class="fas fa-calendar-week"></i> تقرير شهري
                    </button>
                    <button class="btn btn-primary" onclick="generateCustomReport()">
                        <i class="fas fa-calendar-alt"></i> تقرير مخصص
                    </button>
                </div>
            </div>
            
            <div class="report-filters" id="report-filters" style="display: none;">
                <div class="filter-group">
                    <label class="form-label">من تاريخ</label>
                    <input type="date" class="form-control" id="report-start-date">
                </div>
                <div class="filter-group">
                    <label class="form-label">إلى تاريخ</label>
                    <input type="date" class="form-control" id="report-end-date">
                </div>
                <div class="filter-group">
                    <label class="form-label">نوع التقرير</label>
                    <select class="form-control" id="report-type">
                        <option value="all">جميع الفواتير</option>
                        <option value="paid">الفواتير المدفوعة فقط</option>
                        <option value="unpaid">الفواتير غير المدفوعة فقط</option>
                    </select>
                </div>
                <div class="filter-group">
                    <button class="btn btn-primary" onclick="applyReportFilters()">
                        <i class="fas fa-filter"></i> تطبيق
                    </button>
                </div>
            </div>
            
            <div id="report-content">
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div class="stat-value" id="daily-income">0 د.أ</div>
                        <div class="stat-label">إيرادات اليوم</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-week"></i>
                        </div>
                        <div class="stat-value" id="weekly-income">0 د.أ</div>
                        <div class="stat-label">إيرادات الأسبوع</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-month"></i>
                        </div>
                        <div class="stat-value" id="monthly-income">0 د.أ</div>
                        <div class="stat-label">إيرادات الشهر</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-year"></i>
                        </div>
                        <div class="stat-value" id="yearly-income">0 د.أ</div>
                        <div class="stat-label">إيرادات السنة</div>
                    </div>
                </div>
                
                <div class="section-header">
                    <h3><i class="fas fa-chart-pie"></i> توزيع الخدمات الأكثر طلباً</h3>
                </div>
                
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>اسم الخدمة</th>
                                <th>عدد المرات</th>
                                <th>إجمالي الإيرادات</th>
                                <th>النسبة</th>
                            </tr>
                        </thead>
                        <tbody id="top-services">
                            <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                        </tbody>
                    </table>
                </div>
                
                <div class="section-header">
                    <h3><i class="fas fa-file-invoice"></i> تفاصيل الفواتير</h3>
                </div>
                
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>رقم الفاتورة</th>
                                <th>التاريخ</th>
                                <th>العميل</th>
                                <th>الخدمات</th>
                                <th>المبلغ</th>
                                <th>الحالة</th>
                            </tr>
                        </thead>
                        <tbody id="report-invoices">
                            <!-- سيتم تعبئة هذا الجدول بالبيانات ديناميكياً -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <p>© 2023 صالون بنات الورد النسائي. جميع الحقوق محفوظة.</p>
            <p>نظام إدارة الفواتير | العملة: الدينار الأردني (د.أ)</p>
            <p>تصميم وتطوير خاص للصالون | المدير: منار عيروط</p>
        </div>
    </footer>
    
    <!-- Add/Edit Service Modal -->
    <div id="service-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="service-modal-title">إضافة خدمة جديدة</h3>
                <button class="close-modal" onclick="closeModal('service-modal')">&times;</button>
            </div>
            <form id="service-form">
                <div class="form-group">
                    <label class="form-label">اسم الخدمة</label>
                    <input type="text" class="form-control" id="service-name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">السعر (دينار أردني)</label>
                    <input type="number" class="form-control" id="service-price" min="1" step="0.5" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">المدة (دقيقة)</label>
                    <input type="number" class="form-control" id="service-duration" min="5" step="5" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">وصف الخدمة</label>
                    <textarea class="form-control" id="service-description" rows="3"></textarea>
                </div>
                
                <div class="form-group" style="text-align: left;">
                    <button type="submit" class="btn btn-primary" id="service-submit-btn">حفظ الخدمة</button>
                    <button type="button" class="btn btn-outline" onclick="closeModal('service-modal')">إلغاء</button>
                </div>
                <input type="hidden" id="service-id" value="">
            </form>
        </div>
    </div>
    
    <!-- Add/Edit User Modal -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="user-modal-title">إضافة مستخدم جديد</h3>
                <button class="close-modal" onclick="closeModal('user-modal')">&times;</button>
            </div>
            <form id="user-form">
                <div class="form-group">
                    <label class="form-label">اسم المستخدم</label>
                    <input type="text" class="form-control" id="user-name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">البريد الإلكتروني</label>
                    <input type="email" class="form-control" id="user-email" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">رقم الهاتف</label>
                    <input type="tel" class="form-control" id="user-phone" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">الدور</label>
                    <select class="form-control" id="user-role" required>
                        <option value="مدير">مدير</option>
                        <option value="موظف">موظف</option>
                        <option value="محاسب">محاسب</option>
                    </select>
                </div>
                
                <div class="form-group" id="password-group">
                    <label class="form-label">كلمة المرور</label>
                    <input type="password" class="form-control" id="user-password">
                </div>
                
                <div class="form-group" style="text-align: left;">
                    <button type="submit" class="btn btn-primary" id="user-submit-btn">حفظ المستخدم</button>
                    <button type="button" class="btn btn-outline" onclick="closeModal('user-modal')">إلغاء</button>
                </div>
                <input type="hidden" id="user-id" value="">
            </form>
        </div>
    </div>
    
    <!-- Create Invoice Modal -->
    <div id="invoice-modal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title">إنشاء فاتورة جديدة</h3>
                <button class="close-modal" onclick="closeModal('invoice-modal')">&times;</button>
            </div>
            <form id="invoice-form">
                <div class="form-group">
                    <label class="form-label">اسم العميل</label>
                    <input type="text" class="form-control" id="customer-name" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">رقم هاتف العميل</label>
                    <input type="tel" class="form-control" id="customer-phone">
                </div>
                
                <div class="form-group">
                    <label class="form-label">ملاحظات</label>
                    <textarea class="form-control" id="invoice-notes" rows="2"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">اختر الخدمات</label>
                    <div id="services-checklist" style="max-height: 200px; overflow-y: auto; padding: 10px; border: 1px solid var(--medium-gray); border-radius: 6px;">
                        <!-- سيتم تعبئة هذا القسم بالخدمات ديناميكياً -->
                    </div>
                </div>
                
                <div class="form-group">
                    <h4>الخدمات المختارة</h4>
                    <div id="selected-services">
                        <p class="text-muted">لم يتم اختيار أي خدمات بعد</p>
                    </div>
                    <div class="invoice-total">
                        المجموع: <span id="invoice-total-amount">0 د.أ</span>
                    </div>
                </div>
                
                <div class="form-group" style="text-align: left;">
                    <button type="submit" class="btn btn-primary">إنشاء الفاتورة</button>
                    <button type="button" class="btn btn-outline" onclick="closeModal('invoice-modal')">إلغاء</button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript Code -->
    <script>
        // البيانات الأساسية للتطبيق
        let salonData = {
            services: [
                { id: 1, name: "قص وتصفيف", price: 15, duration: 60, description: "قص وتصفيف الشعر حسب الطلب" },
                { id: 2, name: "صبغة شعر", price: 25, duration: 90, description: "صبغة شعر كاملة مع العناية" },
                { id: 3, name: "ميكباج", price: 10, duration: 45, description: "ميكب احترافي للوجه" },
                { id: 4, name: "ميني بديكير", price: 12, duration: 40, description: "عناية بالأظافر والقدمين" },
                { id: 5, name: "عناية بالبشرة", price: 20, duration: 70, description: "تنظيف البشرة وترطيبها" }
            ],
            users: [
                { id: 1, name: "منار عيروط", email: "manar@salon.com", phone: "0791234567", role: "مدير", joinDate: "2023-01-15", password: "admin123" },
                { id: 2, name: "سارة أحمد", email: "sara@example.com", phone: "0797654321", role: "موظف", joinDate: "2023-02-20", password: "user123" },
                { id: 3, name: "لمى خالد", email: "lama@example.com", phone: "0795558888", role: "محاسب", joinDate: "2023-03-10", password: "cashier123" }
            ],
            invoices: [
                { id: 1001, date: "2023-10-05", customer: "أميرة حسن", phone: "0791112233", services: [1, 3], total: 25, status: "مدفوعة", notes: "" },
                { id: 1002, date: "2023-10-06", customer: "فاطمة علي", phone: "0792223344", services: [2, 5], total: 45, status: "مدفوعة", notes: "" },
                { id: 1003, date: "2023-10-07", customer: "حياة عمر", phone: "0793334455", services: [1, 4], total: 27, status: "مدفوعة", notes: "" },
                { id: 1004, date: "2023-10-08", customer: "رنا سعيد", phone: "0794445566", services: [3], total: 10, status: "غير مدفوعة", notes: "" }
            ]
        };

        // حفظ البيانات في localStorage
        function saveData() {
            localStorage.setItem('salonData', JSON.stringify(salonData));
        }

        // تحميل البيانات من localStorage
        function loadData() {
            const savedData = localStorage.getItem('salonData');
            if (savedData) {
                salonData = JSON.parse(savedData);
            }
            updateDashboard();
            renderServices();
            renderInvoices();
            renderUsers();
            renderReports();
        }

        // تحديث لوحة التحكم
        function updateDashboard() {
            document.getElementById('total-invoices').textContent = salonData.invoices.length;
            document.getElementById('total-services').textContent = salonData.services.length;
            document.getElementById('total-users').textContent = salonData.users.length;
            
            const totalRevenue = salonData.invoices
                .filter(invoice => invoice.status === "مدفوعة")
                .reduce((sum, invoice) => sum + invoice.total, 0);
            document.getElementById('total-revenue').textContent = totalRevenue + ' د.أ';
            
            // عرض تاريخ اليوم
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = today.toLocaleDateString('ar-EG', options);
            
            // عرض أحدث الفواتير
            const recentInvoices = salonData.invoices.slice(-5).reverse();
            const recentInvoicesHTML = recentInvoices.map(invoice => {
                const serviceNames = invoice.services.map(serviceId => {
                    const service = salonData.services.find(s => s.id === serviceId);
                    return service ? service.name : 'خدمة غير معروفة';
                }).join(', ');
                
                return `
                    <tr>
                        <td>#${invoice.id}</td>
                        <td>${invoice.date}</td>
                        <td>${invoice.customer}</td>
                        <td>${invoice.total} د.أ</td>
                        <td><span class="status-badge ${invoice.status === 'مدفوعة' ? 'status-paid' : 'status-unpaid'}">${invoice.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                ${invoice.status === 'غير مدفوعة' ? 
                                    `<button class="action-btn pay-btn" onclick="markInvoiceAsPaid(${invoice.id})">
                                        <i class="fas fa-money-bill-wave"></i> دفع
                                    </button>` : ''
                                }
                                <button class="action-btn edit-btn" onclick="viewInvoice(${invoice.id})">
                                    <i class="fas fa-eye"></i> عرض
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('recent-invoices').innerHTML = recentInvoicesHTML;
        }

        // عرض الخدمات
        function renderServices() {
            const servicesList = document.getElementById('services-list');
            servicesList.innerHTML = salonData.services.map(service => `
                <tr>
                    <td>${service.id}</td>
                    <td>${service.name}</td>
                    <td>${service.price} د.أ</td>
                    <td>${service.duration} دقيقة</td>
                    <td>${service.description || '-'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="editService(${service.id})">
                                <i class="fas fa-edit"></i> تعديل
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteService(${service.id})">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // عرض الفواتير
        function renderInvoices() {
            const invoicesList = document.getElementById('invoices-list');
            invoicesList.innerHTML = salonData.invoices.map(invoice => {
                const serviceNames = invoice.services.map(serviceId => {
                    const service = salonData.services.find(s => s.id === serviceId);
                    return service ? service.name : 'خدمة غير معروفة';
                }).join(', ');
                
                return `
                    <tr>
                        <td>#${invoice.id}</td>
                        <td>${invoice.date}</td>
                        <td>${invoice.customer}</td>
                        <td>${invoice.phone || 'غير محدد'}</td>
                        <td>${serviceNames}</td>
                        <td>${invoice.total} د.أ</td>
                        <td><span class="status-badge ${invoice.status === 'مدفوعة' ? 'status-paid' : 'status-unpaid'}">${invoice.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                ${invoice.status === 'غير مدفوعة' ? 
                                    `<button class="action-btn pay-btn" onclick="markInvoiceAsPaid(${invoice.id})">
                                        <i class="fas fa-money-bill-wave"></i> دفع
                                    </button>` : ''
                                }
                                <button class="action-btn edit-btn" onclick="viewInvoice(${invoice.id})">
                                    <i class="fas fa-eye"></i> عرض
                                </button>
                                <button class="action-btn delete-btn" onclick="deleteInvoice(${invoice.id})">
                                    <i class="fas fa-trash"></i> حذف
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // عرض المستخدمين
        function renderUsers() {
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = salonData.users.map(user => `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${user.role}</td>
                    <td>${user.joinDate}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="editUser(${user.id})">
                                <i class="fas fa-edit"></i> تعديل
                            </button>
                            ${user.name !== "منار عيروط" ? `
                            <button class="action-btn delete-btn" onclick="deleteUser(${user.id})">
                                <i class="fas fa-trash"></i> حذف
                            </button>
                            ` : ''}
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // عرض التقارير
        function renderReports(filteredInvoices = null) {
            const invoicesToShow = filteredInvoices || salonData.invoices;
            const today = new Date().toISOString().split('T')[0];
            
            // حساب إيرادات اليوم
            const dailyIncome = invoicesToShow
                .filter(inv => inv.date === today && inv.status === 'مدفوعة')
                .reduce((sum, inv) => sum + inv.total, 0);
            
            document.getElementById('daily-income').textContent = dailyIncome + ' د.أ';
            
            // حساب إيرادات الشهر
            const currentMonth = new Date().getMonth() + 1;
            const currentYear = new Date().getFullYear();
            
            const monthlyIncome = invoicesToShow
                .filter(inv => {
                    const invDate = new Date(inv.date);
                    return invDate.getMonth() + 1 === currentMonth && 
                           invDate.getFullYear() === currentYear && 
                           inv.status === 'مدفوعة';
                })
                .reduce((sum, inv) => sum + inv.total, 0);
            
            document.getElementById('monthly-income').textContent = monthlyIncome + ' د.أ';
            
            // حساب إيرادات الأسبوع
            const oneWeekAgo = new Date();
            oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
            const oneWeekAgoStr = oneWeekAgo.toISOString().split('T')[0];
            
            const weeklyIncome = invoicesToShow
                .filter(inv => inv.date >= oneWeekAgoStr && inv.date <= today && inv.status === 'مدفوعة')
                .reduce((sum, inv) => sum + inv.total, 0);
            
            document.getElementById('weekly-income').textContent = weeklyIncome + ' د.أ';
            
            // حساب إيرادات السنة
            const yearlyIncome = invoicesToShow
                .filter(inv => {
                    const invDate = new Date(inv.date);
                    return invDate.getFullYear() === currentYear && inv.status === 'مدفوعة';
                })
                .reduce((sum, inv) => sum + inv.total, 0);
            
            document.getElementById('yearly-income').textContent = yearlyIncome + ' د.أ';
            
            // حساب الخدمات الأكثر طلباً
            const serviceCount = {};
            invoicesToShow.forEach(invoice => {
                invoice.services.forEach(serviceId => {
                    serviceCount[serviceId] = (serviceCount[serviceId] || 0) + 1;
                });
            });
            
            const topServicesHTML = Object.entries(serviceCount)
                .map(([serviceId, count]) => {
                    const service = salonData.services.find(s => s.id === parseInt(serviceId));
                    if (!service) return '';
                    
                    const totalRevenue = count * service.price;
                    const percentage = (count / invoicesToShow.length * 100).toFixed(1);
                    
                    return `
                        <tr>
                            <td>${service.name}</td>
                            <td>${count}</td>
                            <td>${totalRevenue} د.أ</td>
                            <td>${percentage}%</td>
                        </tr>
                    `;
                })
                .join('');
            
            document.getElementById('top-services').innerHTML = topServicesHTML || 
                '<tr><td colspan="4" class="text-center">لا توجد بيانات بعد</td></tr>';
            
            // عرض الفواتير في التقرير
            const reportInvoicesHTML = invoicesToShow.map(invoice => {
                const serviceNames = invoice.services.map(serviceId => {
                    const service = salonData.services.find(s => s.id === serviceId);
                    return service ? service.name : 'خدمة غير معروفة';
                }).join(', ');
                
                return `
                    <tr>
                        <td>#${invoice.id}</td>
                        <td>${invoice.date}</td>
                        <td>${invoice.customer}</td>
                        <td>${serviceNames}</td>
                        <td>${invoice.total} د.أ</td>
                        <td><span class="status-badge ${invoice.status === 'مدفوعة' ? 'status-paid' : 'status-unpaid'}">${invoice.status}</span></td>
                    </tr>
                `;
            }).join('');
            
            document.getElementById('report-invoices').innerHTML = reportInvoicesHTML || 
                '<tr><td colspan="6" class="text-center">لا توجد فواتير في الفترة المحددة</td></tr>';
        }

        // تبديل الأقسام
        function showSection(sectionId) {
            // إخفاء جميع الأقسام
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // إزالة النشاط من جميع أزرار التنقل
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            // إظهار القسم المطلوب
            document.getElementById(sectionId).classList.add('active');
            
            // إضافة النشاط لزر التنقل المناسب
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
            
            // تحديث البيانات في القسم
            if (sectionId === 'dashboard') updateDashboard();
            if (sectionId === 'reports') renderReports();
        }

        // فتح نافذة منبثقة
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        // إغلاق نافذة منبثقة
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // تحضير قائمة الخدمات للفاتورة
        function prepareInvoiceServices() {
            const servicesChecklist = document.getElementById('services-checklist');
            servicesChecklist.innerHTML = salonData.services.map(service => `
                <div style="margin-bottom: 10px;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" value="${service.id}" data-price="${service.price}" 
                               onchange="updateSelectedServices()" style="width: 18px; height: 18px;">
                        <span>${service.name} - ${service.price} د.أ (${service.duration} دقيقة)</span>
                    </label>
                </div>
            `).join('');
            
            document.getElementById('selected-services').innerHTML = '<p class="text-muted">لم يتم اختيار أي خدمات بعد</p>';
            document.getElementById('invoice-total-amount').textContent = '0 د.أ';
        }

        // تحديث الخدمات المختارة في الفاتورة
        function updateSelectedServices() {
            const checkboxes = document.querySelectorAll('#services-checklist input[type="checkbox"]:checked');
            const selectedServicesDiv = document.getElementById('selected-services');
            let total = 0;
            
            if (checkboxes.length === 0) {
                selectedServicesDiv.innerHTML = '<p class="text-muted">لم يتم اختيار أي خدمات بعد</p>';
            } else {
                let servicesHTML = '<ul style="list-style-type: none; padding: 0;">';
                
                checkboxes.forEach(checkbox => {
                    const serviceId = parseInt(checkbox.value);
                    const service = salonData.services.find(s => s.id === serviceId);
                    if (service) {
                        servicesHTML += `<li>${service.name} - ${service.price} د.أ</li>`;
                        total += service.price;
                    }
                });
                
                servicesHTML += '</ul>';
                selectedServicesDiv.innerHTML = servicesHTML;
            }
            
            document.getElementById('invoice-total-amount').textContent = total + ' د.أ';
        }

        // إضافة أو تعديل خدمة
        function handleServiceSubmit(event) {
            event.preventDefault();
            
            const serviceId = document.getElementById('service-id').value;
            const serviceName = document.getElementById('service-name').value;
            const servicePrice = parseFloat(document.getElementById('service-price').value);
            const serviceDuration = parseInt(document.getElementById('service-duration').value);
            const serviceDescription = document.getElementById('service-description').value;
            
            if (serviceId) {
                // تعديل خدمة موجودة
                const service = salonData.services.find(s => s.id === parseInt(serviceId));
                if (service) {
                    service.name = serviceName;
                    service.price = servicePrice;
                    service.duration = serviceDuration;
                    service.description = serviceDescription;
                }
            } else {
                // إضافة خدمة جديدة
                const newServiceId = salonData.services.length > 0 ? Math.max(...salonData.services.map(s => s.id)) + 1 : 1;
                const newService = {
                    id: newServiceId,
                    name: serviceName,
                    price: servicePrice,
                    duration: serviceDuration,
                    description: serviceDescription
                };
                salonData.services.push(newService);
            }
            
            saveData();
            renderServices();
            updateDashboard();
            closeModal('service-modal');
            
            alert(serviceId ? 'تم تعديل الخدمة بنجاح!' : 'تم إضافة الخدمة بنجاح!');
        }

        // تعديل خدمة
        function editService(id) {
            const service = salonData.services.find(s => s.id === id);
            if (!service) return;
            
            document.getElementById('service-modal-title').textContent = 'تعديل الخدمة';
            document.getElementById('service-submit-btn').textContent = 'تعديل الخدمة';
            document.getElementById('service-id').value = service.id;
            document.getElementById('service-name').value = service.name;
            document.getElementById('service-price').value = service.price;
            document.getElementById('service-duration').value = service.duration;
            document.getElementById('service-description').value = service.description || '';
            
            openModal('service-modal');
        }

        // حذف خدمة
        function deleteService(id) {
            if (confirm('هل أنت متأكد من حذف هذه الخدمة؟')) {
                salonData.services = salonData.services.filter(s => s.id !== id);
                saveData();
                renderServices();
                updateDashboard();
                alert('تم حذف الخدمة بنجاح!');
            }
        }

        // إضافة أو تعديل مستخدم
        function handleUserSubmit(event) {
            event.preventDefault();
            
            const userId = document.getElementById('user-id').value;
            const userName = document.getElementById('user-name').value;
            const userEmail = document.getElementById('user-email').value;
            const userPhone = document.getElementById('user-phone').value;
            const userRole = document.getElementById('user-role').value;
            const userPassword = document.getElementById('user-password').value;
            
            if (userId) {
                // تعديل مستخدم موجود
                const user = salonData.users.find(u => u.id === parseInt(userId));
                if (user) {
                    user.name = userName;
                    user.email = userEmail;
                    user.phone = userPhone;
                    user.role = userRole;
                    if (userPassword) {
                        user.password = userPassword;
                    }
                }
            } else {
                // إضافة مستخدم جديد
                const newUserId = salonData.users.length > 0 ? Math.max(...salonData.users.map(u => u.id)) + 1 : 1;
                const newUser = {
                    id: newUserId,
                    name: userName,
                    email: userEmail,
                    phone: userPhone,
                    role: userRole,
                    joinDate: new Date().toISOString().split('T')[0],
                    password: userPassword || "123456"
                };
                salonData.users.push(newUser);
            }
            
            saveData();
            renderUsers();
            updateDashboard();
            closeModal('user-modal');
            
            alert(userId ? 'تم تعديل المستخدم بنجاح!' : 'تم إضافة المستخدم بنجاح!');
        }

        // تعديل مستخدم
        function editUser(id) {
            const user = salonData.users.find(u => u.id === id);
            if (!user) return;
            
            document.getElementById('user-modal-title').textContent = 'تعديل المستخدم';
            document.getElementById('user-submit-btn').textContent = 'تعديل المستخدم';
            document.getElementById('user-id').value = user.id;
            document.getElementById('user-name').value = user.name;
            document.getElementById('user-email').value = user.email;
            document.getElementById('user-phone').value = user.phone;
            document.getElementById('user-role').value = user.role;
            document.getElementById('user-password').value = '';
            document.getElementById('password-group').style.display = 'block';
            
            openModal('user-modal');
        }

        // حذف مستخدم
        function deleteUser(id) {
            if (confirm('هل أنت متأكد من حذف هذا المستخدم؟')) {
                salonData.users = salonData.users.filter(u => u.id !== id);
                saveData();
                renderUsers();
                updateDashboard();
                alert('تم حذف المستخدم بنجاح!');
            }
        }

        // إنشاء فاتورة جديدة
        function createInvoice(event) {
            event.preventDefault();
            
            const invoiceId = salonData.invoices.length > 0 ? Math.max(...salonData.invoices.map(i => i.id)) + 1 : 1001;
            const customerName = document.getElementById('customer-name').value;
            const customerPhone = document.getElementById('customer-phone').value;
            const invoiceNotes = document.getElementById('invoice-notes').value;
            
            // الحصول على الخدمات المختارة
            const checkboxes = document.querySelectorAll('#services-checklist input[type="checkbox"]:checked');
            const selectedServices = Array.from(checkboxes).map(cb => parseInt(cb.value));
            
            if (selectedServices.length === 0) {
                alert('الرجاء اختيار خدمة واحدة على الأقل');
                return;
            }
            
            // حساب المجموع
            const total = selectedServices.reduce((sum, serviceId) => {
                const service = salonData.services.find(s => s.id === serviceId);
                return sum + (service ? service.price : 0);
            }, 0);
            
            const newInvoice = {
                id: invoiceId,
                date: new Date().toISOString().split('T')[0],
                customer: customerName,
                phone: customerPhone,
                services: selectedServices,
                total: total,
                notes: invoiceNotes,
                status: 'غير مدفوعة'
            };
            
            salonData.invoices.push(newInvoice);
            saveData();
            renderInvoices();
            updateDashboard();
            closeModal('invoice-modal');
            
            alert(`تم إنشاء الفاتورة #${invoiceId} بنجاح! المجموع: ${total} د.أ`);
        }

        // تحديد الفاتورة كمدفوعة
        function markInvoiceAsPaid(id) {
            const invoice = salonData.invoices.find(inv => inv.id === id);
            if (invoice) {
                invoice.status = 'مدفوعة';
                saveData();
                renderInvoices();
                updateDashboard();
                renderReports();
                alert('تم تحديث حالة الفاتورة إلى مدفوعة بنجاح!');
            }
        }

        // حذف فاتورة
        function deleteInvoice(id) {
            if (confirm('هل أنت متأكد من حذف هذه الفاتورة؟')) {
                salonData.invoices = salonData.invoices.filter(i => i.id !== id);
                saveData();
                renderInvoices();
                updateDashboard();
                alert('تم حذف الفاتورة بنجاح!');
            }
        }

        // عرض تفاصيل الفاتورة
        function viewInvoice(id) {
            const invoice = salonData.invoices.find(inv => inv.id === id);
            if (!invoice) return;
            
            const serviceDetails = invoice.services.map(serviceId => {
                const service = salonData.services.find(s => s.id === serviceId);
                return service ? `${service.name} - ${service.price} د.أ` : 'خدمة غير معروفة';
            }).join('<br>');
            
            const invoiceDetails = `
                <div class="invoice-preview">
                    <div class="invoice-header">
                        <h2 class="invoice-title">فاتورة #${invoice.id}</h2>
                        <div>
                            <p><strong>التاريخ:</strong> ${invoice.date}</p>
                            <p><strong>الحالة:</strong> <span class="status-badge ${invoice.status === 'مدفوعة' ? 'status-paid' : 'status-unpaid'}">${invoice.status}</span></p>
                        </div>
                    </div>
                    
                    <div class="invoice-details">
                        <div>
                            <h4>معلومات العميل</h4>
                            <p><strong>الاسم:</strong> ${invoice.customer}</p>
                            <p><strong>الهاتف:</strong> ${invoice.phone || 'غير محدد'}</p>
                        </div>
                        <div>
                            <h4>معلومات الفاتورة</h4>
                            <p><strong>رقم الفاتورة:</strong> #${invoice.id}</p>
                            <p><strong>تاريخ الإنشاء:</strong> ${invoice.date}</p>
                        </div>
                    </div>
                    
                    <div class="invoice-items">
                        <h4>الخدمات المقدمة</h4>
                        <div>${serviceDetails}</div>
                    </div>
                    
                    <div class="invoice-total">
                        المجموع الإجمالي: <strong>${invoice.total} دينار أردني</strong>
                    </div>
                    
                    ${invoice.notes ? `
                    <div style="margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 6px;">
                        <h4>ملاحظات</h4>
                        <p>${invoice.notes}</p>
                    </div>
                    ` : ''}
                    
                    ${invoice.status === 'غير مدفوعة' ? `
                    <div style="text-align: center; margin-top: 25px;">
                        <button class="btn btn-success" onclick="markInvoiceAsPaid(${invoice.id}); this.parentElement.style.display='none'">
                            <i class="fas fa-money-bill-wave"></i> تحديد كمدفوعة
                        </button>
                    </div>
                    ` : ''}
                </div>
            `;
            
            alert(invoiceDetails.replace(/<[^>]*>/g, ''));
        }

        // تصدير الفواتير إلى Excel
        function exportToExcel() {
            // تحضير البيانات للتصدير
            const data = [
                ['رقم الفاتورة', 'التاريخ', 'اسم العميل', 'رقم الهاتف', 'الخدمات', 'المبلغ الإجمالي', 'الحالة', 'ملاحظات']
            ];
            
            salonData.invoices.forEach(invoice => {
                const serviceNames = invoice.services.map(serviceId => {
                    const service = salonData.services.find(s => s.id === serviceId);
                    return service ? service.name : 'خدمة غير معروفة';
                }).join(', ');
                
                data.push([
                    invoice.id,
                    invoice.date,
                    invoice.customer,
                    invoice.phone || 'غير محدد',
                    serviceNames,
                    invoice.total + ' د.أ',
                    invoice.status,
                    invoice.notes || ''
                ]);
            });
            
            // إنشاء ورقة عمل
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // إنشاء مصنف
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "فواتير الصالون");
            
            // حفظ الملف
            const fileName = `فواتير_صالون_بنات_الورد_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            alert('تم تصدير الفواتير بنجاح!');
        }

        // إنشاء تقرير يومي
        function generateDailyReport() {
            const today = new Date().toISOString().split('T')[0];
            const dailyInvoices = salonData.invoices.filter(inv => inv.date === today);
            
            document.getElementById('report-filters').style.display = 'none';
            document.getElementById('report-content').style.display = 'block';
            
            renderReports(dailyInvoices);
            
            // تحديث عنوان التقرير
            document.querySelector('#reports .section-header h2').innerHTML = '<i class="fas fa-chart-bar"></i> التقرير اليومي';
        }

        // إنشاء تقرير شهري
        function generateMonthlyReport() {
            const currentMonth = new Date().getMonth() + 1;
            const currentYear = new Date().getFullYear();
            
            const monthlyInvoices = salonData.invoices.filter(inv => {
                const invDate = new Date(inv.date);
                return invDate.getMonth() + 1 === currentMonth && invDate.getFullYear() === currentYear;
            });
            
            document.getElementById('report-filters').style.display = 'none';
            document.getElementById('report-content').style.display = 'block';
            
            renderReports(monthlyInvoices);
            
            // تحديث عنوان التقرير
            const monthNames = ["يناير", "فبراير", "مارس", "أبريل", "مايو", "يونيو",
                               "يوليو", "أغسطس", "سبتمبر", "أكتوبر", "نوفمبر", "ديسمبر"];
            document.querySelector('#reports .section-header h2').innerHTML = 
                `<i class="fas fa-chart-bar"></i> التقرير الشهري - ${monthNames[currentMonth-1]} ${currentYear}`;
        }

        // إنشاء تقرير مخصص
        function generateCustomReport() {
            document.getElementById('report-filters').style.display = 'flex';
            document.getElementById('report-content').style.display = 'block';
            
            // تعيين التواريخ الافتراضية
            const today = new Date().toISOString().split('T')[0];
            const oneMonthAgo = new Date();
            oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
            const oneMonthAgoStr = oneMonthAgo.toISOString().split('T')[0];
            
            document.getElementById('report-start-date').value = oneMonthAgoStr;
            document.getElementById('report-end-date').value = today;
            
            document.querySelector('#reports .section-header h2').innerHTML = '<i class="fas fa-chart-bar"></i> التقرير المخصص';
        }

        // تطبيق عوامل التصفية للتقرير المخصص
        function applyReportFilters() {
            const startDate = document.getElementById('report-start-date').value;
            const endDate = document.getElementById('report-end-date').value;
            const reportType = document.getElementById('report-type').value;
            
            let filteredInvoices = salonData.invoices.filter(inv => {
                return inv.date >= startDate && inv.date <= endDate;
            });
            
            if (reportType === 'paid') {
                filteredInvoices = filteredInvoices.filter(inv => inv.status === 'مدفوعة');
            } else if (reportType === 'unpaid') {
                filteredInvoices = filteredInvoices.filter(inv => inv.status === 'غير مدفوعة');
            }
            
            renderReports(filteredInvoices);
            
            // تحديث عنوان التقرير
            document.querySelector('#reports .section-header h2').innerHTML = 
                `<i class="fas fa-chart-bar"></i> التقرير المخصص (${startDate} إلى ${endDate})`;
        }

        // تهيئة التطبيق عند التحميل
        document.addEventListener('DOMContentLoaded', function() {
            // تحميل البيانات
            loadData();
            
            // إضافة معالجات الأحداث لأزرار التنقل
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section');
                    showSection(sectionId);
                });
            });
            
            // إضافة معالجات الأحداث للأزرار
            document.getElementById('add-service-btn').addEventListener('click', function() {
                document.getElementById('service-modal-title').textContent = 'إضافة خدمة جديدة';
                document.getElementById('service-submit-btn').textContent = 'حفظ الخدمة';
                document.getElementById('service-id').value = '';
                document.getElementById('service-form').reset();
                openModal('service-modal');
            });
            
            document.getElementById('add-user-btn').addEventListener('click', function() {
                document.getElementById('user-modal-title').textContent = 'إضافة مستخدم جديد';
                document.getElementById('user-submit-btn').textContent = 'حفظ المستخدم';
                document.getElementById('user-id').value = '';
                document.getElementById('password-group').style.display = 'block';
                document.getElementById('user-form').reset();
                openModal('user-modal');
            });
            
            document.getElementById('create-invoice-btn').addEventListener('click', function() {
                document.getElementById('invoice-form').reset();
                prepareInvoiceServices();
                openModal('invoice-modal');
            });
            
            // إضافة معالجات الأحداث للنماذج
            document.getElementById('service-form').addEventListener('submit', handleServiceSubmit);
            document.getElementById('user-form').addEventListener('submit', handleUserSubmit);
            document.getElementById('invoice-form').addEventListener('submit', createInvoice);
            
            // إغلاق النوافذ المنبثقة عند النقر خارجها
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
        });

        // دالة مساعدة لإضافة أنماط إضافية
        function addAdditionalStyles() {
            const style = document.createElement('style');
            style.textContent = `
                .text-muted {
                    color: var(--dark-gray);
                    font-style: italic;
                }
                
                .text-center {
                    text-align: center;
                }
            `;
            document.head.appendChild(style);
        }

        // استدعاء دالة إضافة الأنماط
        addAdditionalStyles();
    </script>
</body>
</html>